{% extends 'base_table_v2.html' %}
{% load static %}
{% block contenido %}
<title>Movimientos Bancarios</title>
<link rel="stylesheet" type="text/css" href="{% static 'css/administracion/administracion.css' %}">
<style>
  .oculto { display: none; }
</style>
<style>
  #formMovBancarios {
    font-size: 0.85rem;
  }

  #formMovBancarios label {
    font-size: 0.8rem;
    margin-bottom: 2px;
  }

  #formMovBancarios .form-control,
  #formMovBancarios .btn,
  #formMovBancarios select {
    font-size: 0.8rem !important;
    height: 26px;
    padding: 2px 6px;
  }

  #formMovBancarios .btn-sm {
    padding: 2px 8px;
  }

  #formMovBancarios .table-sm th,
  #formMovBancarios .table-sm td {
    padding: 4px;
    font-size: 0.8rem;
    vertical-align: middle;
  }

  #formMovBancarios .input-group-append .btn {
    padding: 2px 8px;
  }

  #formMovBancarios .row {
    margin-left: 0;
    margin-right: 0;
  }

  #formMovBancarios .col-md-1,
  #formMovBancarios .col-md-2,
  #formMovBancarios .col-md-3,
  #formMovBancarios .col-md-4,
  #formMovBancarios .col-md-6,
  #formMovBancarios .col-md-9 {
    padding-left: 4px;
    padding-right: 4px;
  }
</style>

<form method="post" id="formMovBancarios" class="container-fluid mt-3">
  {% csrf_token %}

  <div class="border rounded p-3 bg-light">
    <!-- Banco -->
    <div class="row mb-2">
      <div class="col-md-4">
        {{ form.banco.label_tag }}
        {{ form.banco }}
      </div>
    </div>

    <!-- Tipo de movimiento -->
    <div class="row mb-2" >
      <div class="col" style="padding:0;padding-left:5px;">
        <label>{{ form.tipo_movimiento.label }}</label><br>
        {% for radio in form.tipo_movimiento %}
          <div class="form-check form-check-inline">
            {{ radio.tag }}
            <label class="form-check-label" for="{{ radio.id_for_label }}">{{ radio.choice_label }}</label>
          </div>
        {% endfor %}
      </div>
    </div>

    <!-- Fecha, Vto Cheque, Nro Doc -->
    <div class="row mb-2">
      <div class="col-md-3">{{ form.fecha.label_tag }} {{ form.fecha }}</div>
      <div class="col-md-3">{{ form.vto_cheque.label_tag }} {{ form.vto_cheque }}</div>
      <div class="col-md-3">
        {{ form.nro_documento.label_tag }}
        <div class="input-group" style="position: relative;">
          {{ form.nro_documento }}
          <div class="input-group-append">
            <button title="Ver cheques disponibles" class="btn btn-outline-secondary" style="height: 29px;" id="busqueda_cheques" type="button"><i class="fa fa-search"></i></button>
          </div>
        </div>
          <div id="lista_cheques" class="card shadow-sm p-2" style="display:none; position:absolute; z-index:999; width:250px; background:white; border:1px solid #ddd;">
            <strong>Cheques disponibles</strong>
            <ul class="list-group list-group-flush mt-2" id="cheques_lista_ul" style="max-height: 144px; overflow-y: auto;">
              <!-- Cheques se insertan aquí -->
            </ul>
          </div>

      </div>
    </div>

    <!-- Moneda, Arbitraje, Detalle -->
    <div class="row mb-2">
      <div class="col-md-3">{{ form.moneda.label_tag }} {{ form.moneda }}</div>
      <div class="col-md-1">{{ form.arbitraje.label_tag }} {{ form.arbitraje }}</div>
      <div class="col-md-1">{{ form.paridad.label_tag }} {{ form.paridad }}</div>
      <div class="col-md-7">{{ form.detalle.label_tag }} {{ form.detalle }}</div>
      <input type="hidden" name="" id="id_escheque" value="0">
      <input type="hidden" name="" id="id_chequera" value="0">
    </div>
<div class="border rounded bg-white p-2 mb-3">
    <!-- Contra cuenta, Monto, Detalle -->
    <div class="row mb-2">
      <div class="col-md-3">{{ form.cuenta.label_tag }} {{ form.cuenta }}</div>
      <div class="col-md-2">{{ form.monto.label_tag }} {{ form.monto }}</div>
      <div class="col-md-7">{{ form.detalle_cuenta.label_tag }} {{ form.detalle_cuenta }}</div>
    </div>


    <!-- Botones acción -->
    <div class="row mb-3" >
      <div class="col" style="padding:0;padding-left:5px;">
        <button type="button" id="btnGuardar" class="btn btn-success btn-sm">Guardar</button>
        <button type="button" id="btnEliminar" class="btn btn-danger btn-sm">Eliminar</button>
        <button type="button" id="btnClonar" class="btn btn-secondary btn-sm">Clonar</button>
      </div>
    </div>

    <!-- Cheques disponibles y tabla -->
    <div class="row mb-2 align-items-center">
      <div class="col-md-3">
        <button type="button" id="cheques_disponibles_clientes" class="btn btn-warning btn-sm">Cheques disponibles</button>
      </div>
      <div class="col-md-9">
        <div class="table-responsive">
          <table class="table table-bordered table-sm">
            <thead class="thead-light">
              <tr>
                <th>Cuenta</th>
                <th>Total</th>
                <th>Detalle</th>
              </tr>
            </thead>
            <tbody id="tablaCheques">
              <!-- filas -->
            </tbody>
          </table>
        </div>
      </div>
    </div>
    </div>
    <!-- Acumulado -->
    <div class="row mb-3">
      <div class="col-md-3">
        <label>Acumulado</label>
        <input type="text" class="form-control form-control-sm" id="acumulado" readonly>
      </div>
    </div>

    <!-- Finalizar -->
    <div class="row">
      <div class="col-md-2">
        <button type="button" id="btnFinalizar" class="btn btn-primary w-100">Finalizar</button>
      </div>
    </div>

  </div>
</form>
<div id="modalChequesDisponibles" title="Cheques Disponibles" style="display: none;">
  <div class="table-responsive">
    <table class="table table-bordered table-sm table-striped">
      <thead class="thead-light">
        <tr>
          <th>Vencimiento</th>
          <th>Emisión</th>
          <th>Banco</th>
          <th>Número</th>
          <th>Cliente</th>
          <th>Total</th>
          <th class="oculto">autogen</th>
          <th class="oculto">moneda</th>
          <th>Bajar</th>
        </tr>
      </thead>
      <tbody id="tablaChequesDisponibles">
      </tbody>
    </table>
  </div>
  <div id="loadingSpinner" class="text-center my-3" style="display: none;">
  <div class="spinner-border text-primary" role="status" style="width: 2rem; height: 2rem;">
    <span class="sr-only">Cargando...</span>
  </div>
</div>

</div>

<script src="{% static 'grilla/movimientos_bancarios.js' %}"></script>
<script>
  var csrf_token = '{{ csrf_token }}';
</script>
{% endblock contenido %}